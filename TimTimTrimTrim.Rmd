---
title: "TimTimTrimTrim"
output: html_notebook
---

```{r}
library(BiocManager)
library(Biostrings)
```

Test values
```{r}
test_fasta <- "NNGCATGCGATGACTCTTGCTGACCTTTTATTAAGAACTAAATGGACAATATTATGGAGCATTTCATGTATAAATTGGTGCGTAAAATCGTTGGATCTCTCTTCTAAGTACATCCTACTATAACAATCAAGAAAAACAAGAAAATCGGACAAAACAATCAAGTATGGATTCTAGAACAGTTGGTATATTAGGAGGGGGACAATTGGGACGTATGATTGTTGAGTAAGCTAACAGGCTCAACATTAAGACGGTAATACTAGATGCTGAAAATTCTCCTGCCAAACAAATAAGCAACTCCAATGACCACGTTAATGGCTCCTTTTCCAATCCTCTTGATATCGAAAAACTAGCTGAAAAATGTGATGTGCTAACGATTGAGATTGAGCATGTTGATGTTCCTACACTAAAGAATCTTCAAGTAAAACATCCCAAATTAAAAATTTACCCTTCTCCAGAAACAATCAGATTGATACAAGACAAATATATTCAAAAAGAGCATTTAATCAAAAATGGTATAGCAGTTACCCAAAGTGTTCCTGTGGAACAAGCCAGTGAGACGTCCCTATTGAATGTTGGAAGAGATTTGGGTTTTCCATTCGTCTTGAAGTCGAGGACTTTGGCATACGATGGAAGAGGTAACCGCTTTTGTGAAAAGAGAAGAGTCATTTGTCAGCATAGCTGTAATAATCAATCATGACGTAAGAAATGTATCATAATTAAAAGTTGTTAAAGATGTCAGTGTTATGTTGGTGTTACAAAATTCTCGGCTTCTCACTAATATTTAATATCTCTTAAATTTTATCTGTCTTTGATTCTTTTAAGAAAAGTTATGTATTATTCAAGAAAAAGTCAATTCCGCAATCCAAAAGAAGG"

correct_sequence <- "ATGGATTCTAGAACAGTTGGTATATTAGGAGGGGGACAATTGGGACGTATGATTGTTGAGTAAGCTAACAGGCTCAACATTAAGACGGTAATACTAGATGCTGAAAATTCTCC"

L_boundary <- "ATGGATTCTAGAAC"
R_boundary <- "GCTGAAAATTCTCC"
```

Test basic concept
```{r}
test_dna <- DNAString(test_fasta) # convert to Biostrings::DNAString object
L_match <- matchPattern(L_boundary, test_dna) # range of left match
R_match <- matchPattern(R_boundary, test_dna) # range of right match

# does it work
test_dna[start(L_match): end(R_match)] == DNAString(correct_sequence) 

```

Encapsulate
```{r}
TimTimTrimTrim <- function(Subject, L_boundary="", R_boundary=""){ # input as strings
  dna_obj <- DNAString(Subject)
  
  L_match <- matchPattern(L_boundary, dna_obj)
  R_match <- matchPattern(R_boundary, dna_obj)
  
  return(dna_obj[start(L_match):end(R_match)]) # return Biostring object
}

# Does it still work
DNAString(correct_sequence) == TimTimTrimTrim(test_fasta, 
                                              L_boundary="ATGGATTCTAGAAC", 
                                              R_boundary="GCTGAAAATTCTCC")
```

Test Example 2
```{r}
test_fasta2 <- "NNGCATGCGATGACTCTTGCTGACCTTTTATTAAGAACTAAATGGACAATATTATGGAGCATTTCATGTATAAATTGGTGCGTAAAATCGTTGGATCTCTCTTCTAAGTACATCCTACTATAACAATCAAGAAAAACAAGAAAATCGGACAAAACAATCAAGTATGGATTCTAGAACAGTTGGTATATTAGGAGGGGGACAATTGGGACGTATGATTGTTGAGTAAGCTAACAGGCTCAACATTAAGACGGTAATACTAGATGCTGAAAATTCTCCTGCCAAACAAATAAGCAACTCCAATGACCACGTTAATGGCTCCTTTTCCAATCCTCTTGATATCGAAAAACTAGCTGAAAAATGTGATGTGCTAACGATTGAGATTGAGCATGTTGATGTTCCTACACTAAAGAATCTTCAAGTAAAACATCCCAAATTAAAAATTTACCCTTCTCCAGAAACAATCAGATTGATACAAGACAAATATATTCAAAAAGAGCATTTAATCAAAAATGGTATAGCAGTTACCCAAAGTGTTCCTGTGGAACAAGCCAGTGAGACGTCCCTATTGAATGTTGGAAGAGATTTGGGTTTTCCATTCGTCTTGAAGTCGAGGACTTTGGCATACGATGGAAGAGGTAACCGCTTTTGTGAAAAGAGAAGAGTCATTTGTCAGCATAGCTGTAATAATCAATCATGACGTAAGAAATGTATCATAATTAAAAGTTGTTAAAGATGTCAGTGTTATGTTGGTGTTACAAAATTCTCGGCTTCTCACTAATATTTAATATCTCTTAAATTTTATCTGTCTTTGATTCTTTTAAGAAAAGTTATGTATTATTCAAGAAAAAGTCAATTCCGCAATCCAAAAGAAGG"
correct_sequence2 <- "ATGGATTCTAGAACAGTTGGTATATTAGGAGGGGGACAATTGGGACGTATGATTGTTGAGTAAGCTAACAGGCTCAACATTAAGACGGTAATACTAGATGCTGAAAATTCTCC"

DNAString(correct_sequence2) == TimTimTrimTrim(test_fasta2,
                                               L_boundary=L_boundary,
                                               R_boundary=R_boundary)
```

Test Example 3
```{r}
test_fasta3 <- "NCTATAAAGTTCAAGCTGTACTCGTTATGGAGCATTTCATGTATAAATTGGTGCGTAAAATCGTTGGATCTCTCTTCTAAGTACATCCTACTATAACAATCAAGAAAAACAAGAAAATCGGACAAAACAATCAAGTATGGATTCTAGAACAGTTGGTATATTAGGAGGGGGATAATTGTGACGTATGATTGTTGAGTAAGCAAACAGGCTCAACATTAAGACGGTAATACTAGATGCTGAAAATTCTCCTGCCAAACAAATAAGCAACTCCCATGACCACGTTAATGGCTCCTTTTCCAATCCTCTTGATATCGAAAAACTAACTGAAAAATGTGATGTGCTAACGATTGACATTGAGCATGTTGATGTTCCTACACTAAAGAATCTTCACGTAAAACATCCCAAATTAAAAATTTACCCTTCTCCCCAAACAATCACATTGATACAAGACAAATATATTCAAAAAGAGAATTTTTTCACAAATGGTATATCAGTTACCCCAAGTGTTCCTGTGGAACAAGCCAGTGAGACGTCCCTATTGAATGTTGTAAGAGATTTGGGTTTTCCCTTCTCCTTGAAGTCGAGGACTTTGTTATATTATGGAAAAGGTAACTTCGCTGTAAAGAATAAGGAAATGATTCCGGAGACTTTGTAAATACTGAAAGATCCTCCTTTTGTACGCCGAAAA"

correct_sequence3 <- "ATGGATTCTAGAACAGTTGGTATATTAGGAGGGGGATAATTGTGACGTATGATTGTTGAGTAAGCAAACAGGCTCAACATTAAGACGGTAATACTAGATGCTGAAAATTCTCC"

DNAString(correct_sequence3) == TimTimTrimTrim(test_fasta3,
                                               L_boundary=L_boundary,
                                               R_boundary=R_boundary)
```

